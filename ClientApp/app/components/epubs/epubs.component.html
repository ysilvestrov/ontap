<h1>Редактировать список пабов</h1>

<p>На этой странице можно редактировать список пабов, а также добавлять новые.</p>

<p *ngIf="!elements">
    <em>Loading...</em>
</p>
<div class="alert alert-danger" role="alert" *ngIf="errorMessage">
    {{errorMessage}}
</div>

<div class="container-fluid" *ngIf="elements">
    <div class="row">
        <div class="col-md-3"><h4><strong>Название</strong></h4></div>
        <div class="col-md-2"><h4><strong>Город</strong></h4></div>
        <div class="col-md-5"><h4><strong>Адрес</strong></h4></div>
        <div class="col-md-2"><h4><strong>Действия</strong></h4></div>
    </div>
    <div class="row-wrapper" *ngFor="let pub of elements">
        <div class="row" *ngIf="!editing || (editing.id != pub.id)">
            <div class="col-md-3">{{ pub.name }}</div>
            <div class="col-md-2">{{ pub.city.name }}</div>
            <div class="col-md-5">{{ pub.address }}</div>
            <div class="col-md-2">
                <button (click)="edit(pub.id)" type="button" class="btn btn-default" aria-label="Edit">
                    <span class="glyphicon glyphicon-edit" aria-hidden="true"></span>
                </button>
            </div>
        </div>
        <div class="row" *ngIf="editing && (editing.id == pub.id)">
            <div class="col-md-3">
                <input type="text" class="form-control" id="editing.name"
                       required
                       [(ngModel)]="editing.name" name="name">
            </div>
            <div class="col-md-2">
                <select class="form-control" [(ngModel)]="editing.city.id" (change)="onEditChangeCity($event.target.value)">
                    <option *ngFor="let city of cities" [value]="city.id">{{city.name}}</option>
                </select>
            </div>
            <div class="col-md-5">
                <input type="text" class="form-control" id="editing.address"
                       required
                       [(ngModel)]="editing.address" name="address">
            </div>
            <div class="col-md-2">
                <button (click)="save()" type="button" class="btn btn-primary" aria-label="Save">
                    <span class="glyphicon glyphicon-save" aria-hidden="true"></span>
                </button>
                <button (click)="cancelEdit()" type="button" class="btn btn-default" aria-label="Cancel">
                    <span class="glyphicon glyphicon-remove" aria-hidden="true"></span>
                </button>
            </div>
        </div>
        <div class="row edit2" *ngIf="editing && (editing.id == pub.id)">
            <div class="col-md-1">
                <img *ngIf="editing.image" [src]="'http://res.cloudinary.com/ontap-in-ua/image/upload/'+editing.image+'.png'"/>
            </div>
            <div class="col-md-4">
                <input type="file" ng2FileSelect [uploader]="uploader" />
            </div>
            <div class="col-md-7"></div>
        </div>
    </div>
</div>

<table class='table' *ngIf="elements">
    <thead>
    <tr>
        <th>Служебный Id</th>
        <th>Название</th>
        <th>Город</th>
        <th>Адрес</th>
        <th>Действия</th>
    </tr>
    </thead>
    <tbody>
    <tr *ngIf="adding">
        <td>
            <input type="text" class="form-control" id="adding.id"
                   required
                   [(ngModel)]="adding.id" name="id">
        </td>
        <td>
            <input type="text" class="form-control" id="adding.name"
                   required
                   [(ngModel)]="adding.name" name="name">
        </td>
        <td>
            <select class="form-control" [(ngModel)]="adding.city.id" (change)="onEditChangeCity($event.target.value)">
                <option *ngFor="let city of cities" [value]="city.id">{{city.name}}</option>
            </select>
        </td>
        <td>
            <input type="text" class="form-control" id="adding.address"
                   required
                   [(ngModel)]="adding.address" name="address">
        </td>
        <td>
            <button (click)="add()" type="button" class="btn btn-primary" aria-label="Add">
                <span class="glyphicon glyphicon-save" aria-hidden="true"></span>
            </button>
            <button (click)="cancelEdit()" type="button" class="btn btn-default" aria-label="Cancel">
                <span class="glyphicon glyphicon-remove" aria-hidden="true"></span>
            </button>
        </td>
    </tr>
    </tbody>
</table>
<button (click)="startAdd()" type="button" class="btn btn-default" aria-label="Add">
    <span class="glyphicon glyphicon-plus" aria-hidden="true"></span>
</button>